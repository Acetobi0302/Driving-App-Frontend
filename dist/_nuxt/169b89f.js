(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{528:function(e,t,r){var content=r(553);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(72).default)("d3602f1c",content,!0,{sourceMap:!1})},552:function(e,t,r){"use strict";r(528)},553:function(e,t,r){var o=r(71)(!1);o.push([e.i,".selection{height:calc(1.5em + 1.25rem + 2px)}.ui.dropdown,.ui.dropdown input{line-height:1.3rem!important}.ui.selection.dropdown>.dropdown.icon{top:.8rem!important}.trito{display:inline-block!important;box-shadow:0 1px 3px rgb(87 87 99/40%),0 1px 0 rgb(0 0 0/2%)!important;border:0!important;color:#8898aa!important;font-size:.875rem!important;font-weight:400!important;border-radius:.375rem!important}",""]),e.exports=o},593:function(e,t,r){"use strict";r.r(t);var o=r(20),n=(r(75),r(180),r(27),r(76),r(58),r(31),r(97),r(59),{components:{ModelSelect:r(520).ModelSelect},props:{event:{type:Object,default:null},isEdit:{type:Boolean,default:!0},revert:{type:Function,default:null},franchiseId:{type:Number,default:null},isDeleted:{type:Boolean,default:!1},driverId:{type:Number,default:null}},data:function(){return{course:null,minis:30,calBusy:!1,loading:!1,classes_id:null,start:null,art:null,end:null,hours:Array.from({length:19}).map((function(e,i){return i+5})),form:{id:null,amount:null,student_id:null,franchise_id:null,car_id:null,date:null,start:null,end:null,note:null,paid:!1,driver_id:null,course_id:null}}},computed:{drivers:function(){return this.$store.state.drivers},franchises:function(){return this.$store.state.franchiselist},studentlist:function(){return this.$store.state.studentlist},coursesList:function(){return this.$store.state.coursesList},classes:function(){return this.$store.getters.getClassesList},carList:function(){return this.$store.state.carList}},mounted:function(){this.$nextTick(Object(o.a)(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.form.driver_id=this.driverId,this.form.franchise_id=this.franchiseId,this.form.date=this.event.startStr.slice(0,10),this.start=this.event.startStr.slice(11,16),this.end=this.endDate(),!this.isEdit){e.next=26;break}return this.calBusy=!0,this.classes_id=this.event.extendedProps.class_id,e.next=10,this.getCoursesArts();case 10:if(!(t=this.coursesList.find((function(e){return(e.value&&e.value.id)===r.event.extendedProps.course_id})))){e.next=19;break}return this.course=t.value,e.next=15,this.getCourseChange();case 15:this.form.car_id=this.event.extendedProps.car_id,this.art=this.event.extendedProps.course_art,e.next=21;break;case 19:this.form.car_id=null,this.art=null;case 21:this.form.student_id=this.event.extendedProps.student_id,this.form.paid=this.event.extendedProps.paid,this.form.amount=this.event.extendedProps.amount,this.form.id=this.event.id,this.calBusy=!1;case 26:case"end":return e.stop()}}),e,this)}))))},methods:{hideModal:function(){var e=this;this.$nextTick((function(){e.$refs.addBooking.hide()}))},onhide:function(){},getCoursesArts:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.calBusy=!0,e.course=null,e.form.car_id=null,t.next=5,e.$store.dispatch("getCoursesArtList",e.classes_id);case 5:e.calBusy=!1;case 6:case"end":return t.stop()}}),t)})))()},getCourseChange:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.calBusy=!0,e.form.car_id=null,e.minis=e.course.course_time_duration,e.art=e.course.art,e.end=e.endDate(),t.next=7,e.$store.dispatch("getCarList",{user_id:e.form.driver_id,franchise_id:e.form.franchise_id,art:e.art});case 7:e.calBusy=!1;case 8:case"end":return t.stop()}}),t)})))()},getTimeChange:function(){this.end=this.endDate()},bookSlot:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loading=!0,""===e.form.amount&&(e.form.amount=null),e.form.course_id=e.course.id,e.form.start=e.form.date+" "+e.start+":00",e.form.end=e.form.date+" "+e.end+":00",e.form.note=null!=e.form.note?e.form.note.trim():e.form.note,!e.isEdit){t.next=12;break}return t.next=9,e.$store.dispatch("updateSlot",e.form);case 9:r=t.sent,t.next=15;break;case 12:return t.next=14,e.$store.dispatch("bookSlot",e.form);case 14:r=t.sent;case 15:r&&(e.loading=!1,e.$emit("exit"),e.$emit("refresh")),e.loading=!1;case 17:case"end":return t.stop()}}),t)})))()},endDate:function(){var e=parseInt(this.start.slice(0,2))+Math.floor(this.minis/60),t=parseInt(this.start.slice(3,5))+this.minis%60;return t>60&&(e+=Math.floor(t/60),t%=60),60===t&&(e+=1,t="00"),t=1===(t+="").length?"0"+t:t,(e=1===(e+="").length?"0"+e:e)+":"+t}}}),l=(r(552),r(30)),component=Object(l.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ValidationObserver",{scopedSlots:e._u([{key:"default",fn:function(t){var o=t.invalid;return[r("b-overlay",{staticClass:"position-clock",attrs:{variant:"white",opacity:.3,blur:"1rem",rounded:"sm",show:e.calBusy}},[r("b-form",{on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.bookSlot.apply(null,arguments)}}},[r("b-row",[r("b-col",[r("b-form-group",{staticClass:"form-control-label",attrs:{label:e.$tc("Franchise")}},[r("b-form-select",{staticClass:"form-control-alternative",attrs:{name:e.$tc("Franchise"),rules:"required",options:e.franchises,required:"",disabled:""},model:{value:e.form.franchise_id,callback:function(t){e.$set(e.form,"franchise_id",t)},expression:"form.franchise_id"}})],1)],1),e._v(" "),r("b-col",[r("b-form-group",{staticClass:"form-control-label",attrs:{label:e.$tc("Driver")}},[r("b-form-select",{staticClass:"form-control-alternative",attrs:{name:e.$tc("Driver"),options:e.drivers,disabled:""},model:{value:e.form.driver_id,callback:function(t){e.$set(e.form,"driver_id",t)},expression:"form.driver_id"}})],1)],1),e._v(" "),r("b-col",[r("ValidationProvider",{attrs:{name:"Student",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.errors;return[r("label",{staticClass:"form-control-label"},[e._v(e._s(e.$tc("Student")))]),e._v(" "),r("model-select",{staticClass:"trito",attrs:{options:e.studentlist,name:e.$tc("Student"),placeholder:"select "+e.$tc("Student")},model:{value:e.form.student_id,callback:function(t){e.$set(e.form,"student_id",t)},expression:"form.student_id"}}),e._v(" "),r("span",{staticClass:"invalid-feedback",staticStyle:{display:"block"},attrs:{id:"error"}},[e._v(e._s(o[0]))]),e._v(" "),r("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"},{name:"model",rawName:"v-model",value:e.form.student_id,expression:"form.student_id"}],attrs:{type:"text"},domProps:{value:e.form.student_id},on:{input:function(t){t.target.composing||e.$set(e.form,"student_id",t.target.value)}}})]}}],null,!0)})],1)],1),e._v(" "),r("b-row",[r("b-col",[r("b-form-group",{staticClass:"form-control-label",attrs:{label:e.$tc("ClassesName")}},[r("b-form-select",{staticClass:"form-control-alternative",attrs:{name:e.$tc("ClassesName"),rules:"required",options:e.classes,required:"",disabled:e.isEdit},on:{change:e.getCoursesArts},model:{value:e.classes_id,callback:function(t){e.classes_id=t},expression:"classes_id"}})],1)],1),e._v(" "),r("b-col",[r("b-form-group",{staticClass:"form-control-label",attrs:{label:e.$tc("CourseName")}},[r("b-form-select",{staticClass:"form-control-alternative",attrs:{name:e.$tc("CourseName"),rules:"required",options:e.coursesList,required:""},on:{change:e.getCourseChange},model:{value:e.course,callback:function(t){e.course=t},expression:"course"}})],1)],1),e._v(" "),r("b-col",[r("b-form-group",{staticClass:"form-control-label",attrs:{label:e.$tc("Car")}},[r("b-form-select",{staticClass:"form-control-alternative",attrs:{name:e.$tc("Car"),rules:"required",options:e.carList,required:""},model:{value:e.form.car_id,callback:function(t){e.$set(e.form,"car_id",t)},expression:"form.car_id"}})],1)],1)],1),e._v(" "),r("b-row",[r("b-col",[r("ValidationProvider",{attrs:{name:e.$tc("Date"),rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.errors;return[r("label",{staticClass:"form-control-label"},[e._v(e._s(e.$tc("Date")))]),e._v(" "),r("date-picker",{staticClass:"input-group input-group-alternative",attrs:{locale:"de",clearable:!1,editable:!1,disabled:!e.isEdit,required:!0,placeholder:"Select date","value-type":"format"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}}),e._v(" "),r("span",{staticClass:"invalid-feedback",staticStyle:{display:"block"},attrs:{id:"error"}},[e._v(e._s(o[0]))]),e._v(" "),r("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"},{name:"model",rawName:"v-model",value:e.form.date,expression:"form.date"}],attrs:{type:"text"},domProps:{value:e.form.date},on:{input:function(t){t.target.composing||e.$set(e.form,"date",t.target.value)}}})]}}],null,!0)})],1),e._v(" "),r("b-col",[r("ValidationProvider",{attrs:{name:"Start Time",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.errors;return[r("label",{staticClass:"form-control-label"},[e._v(e._s(e.$tc("StartTime")))]),e._v(" "),r("date-picker",{staticClass:"input-group input-group-alternative",attrs:{locale:"de","hour-options":e.hours,format:"HH:mm","value-type":"format",type:"time",placeholder:"HH:mm",clearable:!1,editable:!1,required:!0},on:{change:e.getTimeChange},model:{value:e.start,callback:function(t){e.start=t},expression:"start"}}),e._v(" "),r("span",{staticClass:"invalid-feedback",staticStyle:{display:"block"},attrs:{id:"error"}},[e._v(e._s(o[0]))]),e._v(" "),r("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"},{name:"model",rawName:"v-model",value:e.start,expression:"start"}],attrs:{type:"text"},domProps:{value:e.start},on:{input:function(t){t.target.composing||(e.start=t.target.value)}}})]}}],null,!0)})],1),e._v(" "),r("b-col",[r("ValidationProvider",{attrs:{name:"End Time",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.errors;return[r("label",{staticClass:"form-control-label"},[e._v(e._s(e.$tc("EndTime")))]),e._v(" "),r("date-picker",{staticClass:"input-group input-group-alternative",attrs:{locale:"de",clearable:!1,editable:!1,required:!0,"hour-options":e.hours,format:"HH:mm","value-type":"format",type:"time",disabled:"",placeholder:"HH:mm"},model:{value:e.end,callback:function(t){e.end=t},expression:"end"}}),e._v(" "),r("span",{staticClass:"invalid-feedback",staticStyle:{display:"block"},attrs:{id:"error"}},[e._v(e._s(o[0]))]),e._v(" "),r("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"},{name:"model",rawName:"v-model",value:e.end,expression:"end"}],attrs:{type:"text"},domProps:{value:e.end},on:{input:function(t){t.target.composing||(e.end=t.target.value)}}})]}}],null,!0)})],1)],1),e._v(" "),r("b-row",{staticClass:"pt-3"},[r("b-col",[r("base-input",{attrs:{alternative:"",name:e.$tc("Duration"),label:e.$tc("Duration"),placeholder:e.$tc("Duration"),"prepend-icon":"fas fa-angle-right fa-lg",disabled:""},model:{value:e.minis,callback:function(t){e.minis=t},expression:"minis"}})],1),e._v(" "),r("b-col",[r("base-input",{attrs:{alternative:"",name:e.$tc("Amount"),type:"number",rules:"integer|min_value:1",label:e.$tc("Amount"),placeholder:e.$tc("Amount"),"prepend-icon":"fas fa-angle-right fa-lg"},model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}})],1),e._v(" "),r("b-col",[r("b-form-group",{staticStyle:{"margin-top":"2.2rem"}},[r("label",{staticClass:"pl-0 mr-2 form-control-label text-right"},[e._v(e._s(e.$tc("Paid")))]),e._v(" "),r("label",{staticClass:"switch",staticStyle:{"vertical-align":"middle","margin-bottom":"0.3rem"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.paid,expression:"form.paid"}],attrs:{id:"togBtn",type:"checkbox"},domProps:{checked:Array.isArray(e.form.paid)?e._i(e.form.paid,null)>-1:e.form.paid},on:{change:function(t){var r=e.form.paid,o=t.target,n=!!o.checked;if(Array.isArray(r)){var l=e._i(r,null);o.checked?l<0&&e.$set(e.form,"paid",r.concat([null])):l>-1&&e.$set(e.form,"paid",r.slice(0,l).concat(r.slice(l+1)))}else e.$set(e.form,"paid",n)}}}),e._v(" "),r("div",{staticClass:"slider round"},[r("span",{staticClass:"on"},[e._v(e._s(e.$tc("Yes")))]),e._v(" "),r("span",{staticClass:"off"},[e._v(e._s(e.$tc("No")))])])])])],1)],1),e._v(" "),r("b-row",[r("b-col",[r("base-input",{attrs:{alternative:"",name:e.$tc("Note"),label:e.$tc("Note"),placeholder:e.$tc("Note"),"prepend-icon":"fas fa-angle-right fa-lg"},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1)],1),e._v(" "),r("div",{staticClass:"modal-footer"},[e.isDeleted?e._e():r("b-button",{attrs:{type:"submit",disabled:o||e.loading,variant:"primary"}},[e.loading?r("b-spinner",{staticClass:"mx-2",attrs:{small:""}}):e._e(),e.loading?e._e():r("span",[e._v(e._s(e.isEdit?e.$tc("save"):e.$tc("submit")))])],1)],1)],1)],1)]}}])})}),[],!1,null,null,null);t.default=component.exports}}]);